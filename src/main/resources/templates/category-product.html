<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <title>Pustok - Book Store HTML Template</title>
    <th:block th:include="layout/head"/>
    <style>
        .product-card .product-header .author,
        .product-card .product-header h3 {
            white-space: nowrap;
        }
    </style>
</head>

<body>
<div class="site-wrapper" id="top">
    <div class="site-header header-2 mb--20 d-none d-lg-block">
        <div class="header-middle pt--10 pb--10">
            <th:block th:include="layout/site-header/header-middle"/>
        </div>
        <div class="header-bottom bg-primary">
            <th:block th:include="layout/site-header/header-bottom"/>
        </div>
    </div>
    <div class="site-mobile-menu">
        <header class="mobile-header d-block d-lg-none pt--10 pb-md--10">
            <div class="container">
                <div class="row align-items-sm-end align-items-center">
                    <div class="col-md-4 col-7">
                        <a href="/" class="site-brand">
                            <!--                            <img src="/assets/image/logo.png" alt="">-->
                            <img src="/assets/image/logoProject.png" alt="" width="100%" height="100%">
                        </a>
                    </div>
                    <div class="col-md-5 order-3 order-md-2">
                        <nav class="category-nav   ">
                            <div>
                                <a href="javascript:void(0)" class="category-trigger"><i
                                        class="fa fa-bars"></i>Browse
                                    categories</a>
                                <ul class="category-menu">

                                    <th:block  th:each= "item : ${categories}">
                                        <li class="cat-item has-children">
                                            <a th:href="@{/category/__${item.slug}__}" th:text="${item.name}"></a>
                                            <ul class="sub-menu">
                                                <th:block th:each = "group : ${categoryGroups}">
                                                    <th:block th:if = "${group.getCategory().getId() == item.getId()}">
                                                        <li><a th:href= "@{/categoryGroup/__${group.slug}__}" th:text="${group.name}"></a></li>
                                                    </th:block>
                                                </th:block>
                                            </ul>
                                        </li>
                                    </th:block>

                                </ul>
                            </div>
                        </nav>
                    </div>
                    <div class="col-md-3 col-5  order-md-3 text-right">
                        <div class="mobile-header-btns header-top-widget">
                            <ul class="header-links">
                                <li class="sin-link">
                                    <a href="cart.html" class="cart-link link-icon"><i class="ion-bag"></i></a>
                                </li>
                                <li class="sin-link">
                                    <a href="javascript:" class="link-icon hamburgur-icon off-canvas-btn"><i
                                            class="ion-navicon"></i></a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </header>
        <!--Off Canvas Navigation Start-->
        <aside class="off-canvas-wrapper">
            <div class="btn-close-off-canvas">
                <i class="ion-android-close"></i>
            </div>
            <div class="off-canvas-inner">
                <!-- search box start -->
                <div class="search-box offcanvas">
                    <form>
                        <input type="text" placeholder="Search Here">
                        <button class="search-btn"><i class="ion-ios-search-strong"></i></button>
                    </form>
                </div>
                <!-- search box end -->
                <!-- mobile menu start -->
                <div class="mobile-navigation">
                    <!-- mobile menu navigation start -->
                    <nav class="off-canvas-nav">
                        <ul class="mobile-menu main-mobile-menu">
                            <li class="menu-item-has-children">
                                <a href="#">Blog</a>
                                <ul class="sub-menu">
                                    <li class="menu-item-has-children">
                                        <a href="#">Blog Grid</a>
                                        <ul class="sub-menu">
                                            <li><a href="blog.html">Full Widh (Default)</a></li>
                                            <li><a href="blog-left-sidebar.html">left Sidebar</a></li>
                                            <li><a href="blog-right-sidebar.html">Right Sidebar</a></li>
                                        </ul>
                                    </li>
                                    <li class="menu-item-has-children">
                                        <a href="#">Blog List</a>
                                        <ul class="sub-menu">
                                            <li><a href="blog-list.html">Full Widh (Default)</a></li>
                                            <li><a href="blog-list-left-sidebar.html">left Sidebar</a></li>
                                            <li><a href="blog-list-right-sidebar.html">Right Sidebar</a></li>
                                        </ul>
                                    </li>
                                    <li class="menu-item-has-children">
                                        <a href="#">Blog Details</a>
                                        <ul class="sub-menu">
                                            <li><a href="blog-details.html">Image Format (Default)</a></li>
                                            <li><a href="blog-details-gallery.html">Gallery Format</a></li>
                                            <li><a href="blog-details-audio.html">Audio Format</a></li>
                                            <li><a href="blog-details-video.html">Video Format</a></li>
                                            <li><a href="blog-details-left-sidebar.html">left Sidebar</a></li>
                                        </ul>
                                    </li>
                                </ul>
                            </li>
                            <li class="menu-item-has-children">
                                <a href="#">Shop</a>
                            </li>
                            <li class="menu-item-has-children">
                                <a href="#">Pages</a>
                                <ul class="sub-menu">
                                    <li><a href="cart.html">Cart</a></li>
                                    <li><a href="checkout.html">Checkout</a></li>
                                    <li><a href="compare.html">Compare</a></li>
                                    <li><a href="wishlist.html">Wishlist</a></li>

                                    <th:block th:if="!${username}">
                                        <li><a href="login-register.html">Login Register</a></li>
                                    </th:block>

                                    <th:block th:if="${username}">
                                        <li><a href="my-account.html">My Account</a></li>
                                    </th:block>

                                    <li><a href="order-complete.html">Order Complete</a></li>
                                    <li><a href="faq.html">Faq</a></li>
                                    <li><a href="contact-2.html">contact 02</a></li>
                                </ul>
                            </li>
                            <li><a href="contact.html">Contact</a></li>
                        </ul>
                    </nav>
                    <!-- mobile menu navigation end -->
                </div>
                <!-- mobile menu end -->
                <nav class="off-canvas-nav">

                </nav>
                <div class="off-canvas-bottom">
                    <div class="contact-list mb--10">
                        <a href="#" class="sin-contact"><i class="fas fa-mobile-alt"></i>(12345) 78790220</a>
                        <a href="#" class="sin-contact"><i class="fas fa-envelope"></i>examle@handart.com</a>
                    </div>
                    <div class="off-canvas-social">
                        <a href="#" class="single-icon"><i class="fab fa-facebook-f"></i></a>
                        <a href="#" class="single-icon"><i class="fab fa-twitter"></i></a>
                        <a href="#" class="single-icon"><i class="fas fa-rss"></i></a>
                        <a href="#" class="single-icon"><i class="fab fa-youtube"></i></a>
                        <a href="#" class="single-icon"><i class="fab fa-google-plus-g"></i></a>
                        <a href="#" class="single-icon"><i class="fab fa-instagram"></i></a>
                    </div>
                </div>
            </div>
        </aside>
        <!--Off Canvas Navigation End-->
    </div>

    <div class="sticky-init fixed-header common-sticky">
        <div class="container d-none d-lg-block">
            <div class="row align-items-center">
                <div class="col-lg-4">
                    <a href="/" class="site-brand">
                        <!--                        <img src="/assets/image/logo.png" alt="">-->
                        <img src="/assets/image/logoProject.png" alt="" width="100%" height="100%">
                    </a>
                </div>
                <div class="col-lg-8">
                    <div class="main-navigation flex-lg-right">
                        <ul class="main-menu menu-right ">
                            <li class="menu-item ">
                                <a href="/">Home</a>
                            </li>
                            <!-- Shop -->
                            <li class="menu-item has-children mega-menu">
                                <a href="javascript:void(0)">Shop <i
                                        class="fas fa-chevron-down dropdown-arrow"></i></a>
                                <ul class="sub-menu four-column">
                                    <li class="cus-col-25">
                                        <h3 class="menu-title"><a href="javascript:void(0)">Shop Grid </a></h3>
                                        <ul class="mega-single-block">
                                            <li><a href="shop-grid.html">Fullwidth</a></li>
                                            <li><a href="shop-grid-left-sidebar.html">left Sidebar</a></li>
                                            <li><a href="shop-grid-right-sidebar.html">Right Sidebar</a></li>
                                        </ul>
                                    </li>
                                    <li class="cus-col-25">
                                        <h3 class="menu-title"><a href="javascript:void(0)">Shop List</a></h3>
                                        <ul class="mega-single-block">
                                            <li><a href="shop-list.html">Fullwidth</a></li>
                                            <li><a href="shop-list-left-sidebar.html">left Sidebar</a></li>
                                            <li><a href="shop-list-right-sidebar.html">Right Sidebar</a></li>
                                        </ul>
                                    </li>
                                    <li class="cus-col-25">
                                        <h3 class="menu-title"><a href="javascript:void(0)">Product Details 1</a>
                                        </h3>
                                        <ul class="mega-single-block">
                                            <li><a href="product-details.html">Product Details Page</a></li>
                                            <li><a href="product-details-affiliate.html">Product Details
                                                Affiliate</a></li>
                                            <li><a href="product-details-group.html">Product Details Group</a></li>
                                            <li><a href="product-details-variable.html">Product Details
                                                Variables</a></li>
                                        </ul>
                                    </li>
                                    <li class="cus-col-25">
                                        <h3 class="menu-title"><a href="javascript:void(0)">Product Details 2</a>
                                        </h3>
                                        <ul class="mega-single-block">
                                            <li><a href="product-details-left-thumbnail.html">left Thumbnail</a>
                                            </li>
                                            <li><a href="product-details-right-thumbnail.html">Right Thumbnail</a>
                                            </li>
                                            <li><a href="product-details-left-gallery.html">Left Gallery</a></li>
                                            <li><a href="product-details-right-gallery.html">Right Gallery</a></li>
                                        </ul>
                                    </li>
                                </ul>
                            </li>
                            <!-- Pages -->
                            <li class="menu-item has-children">
                                <a href="javascript:void(0)">Pages <i
                                        class="fas fa-chevron-down dropdown-arrow"></i></a>
                                <ul class="sub-menu">
                                    <li><a href="cart.html">Cart</a></li>
                                    <li><a href="checkout.html">Checkout</a></li>
                                    <li><a href="compare.html">Compare</a></li>
                                    <li><a href="wishlist.html">Wishlist</a></li>

                                    <th:block th:if="!${username}">
                                        <li><a href="login-register.html">Login Register</a></li>
                                    </th:block>

                                    <th:block th:if="${username}">
                                        <li><a href="my-account.html">My Account</a></li>
                                    </th:block>

                                    <li><a href="order-complete.html">Order Complete</a></li>
                                    <li><a href="faq.html">Faq</a></li>
                                    <li><a href="contact-2.html">contact 02</a></li>
                                </ul>
                            </li>
                            <!-- Blog -->
                            <li class="menu-item has-children mega-menu">
                                <a href="javascript:void(0)">Blog <i
                                        class="fas fa-chevron-down dropdown-arrow"></i></a>
                                <ul class="sub-menu three-column">
                                    <li class="cus-col-33">
                                        <h3 class="menu-title"><a href="javascript:void(0)">Blog Grid</a></h3>
                                        <ul class="mega-single-block">
                                            <li><a href="blog.html">Full Widh (Default)</a></li>
                                            <li><a href="blog-left-sidebar.html">left Sidebar</a></li>
                                            <li><a href="blog-right-sidebar.html">Right Sidebar</a></li>
                                        </ul>
                                    </li>
                                    <li class="cus-col-33">
                                        <h3 class="menu-title"><a href="javascript:void(0)">Blog List </a></h3>
                                        <ul class="mega-single-block">
                                            <li><a href="blog-list-left-sidebar.html">left Sidebar</a></li>
                                            <li><a href="blog-list-right-sidebar.html">Right Sidebar</a></li>
                                        </ul>
                                    </li>
                                    <li class="cus-col-33">
                                        <h3 class="menu-title"><a href="javascript:void(0)">Blog Details</a></h3>
                                        <ul class="mega-single-block">
                                            <li><a href="blog-details.html">Image Format (Default)</a></li>
                                            <li><a href="blog-details-gallery.html">Gallery Format</a></li>
                                            <li><a href="blog-details-audio.html">Audio Format</a></li>
                                            <li><a href="blog-details-video.html">Video Format</a></li>
                                            <li><a href="blog-details-left-sidebar.html">left Sidebar</a></li>
                                        </ul>
                                    </li>
                                </ul>
                            </li>
                            <li class="menu-item">
                                <a href="contact.html">Contact</a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <section class="breadcrumb-section">
        <h2 class="sr-only">Site Breadcrumb</h2>
        <div class="container">
            <div class="breadcrumb-contents">
                <nav aria-label="breadcrumb">
                    <ol class="breadcrumb">
                        <li class="breadcrumb-item"><a href="/">Home</a></li>
                        <li class="breadcrumb-item active" th:text="${categoryGroupBySlug.name}"></li>
                    </ol>
                </nav>
            </div>
        </div>
    </section>
    <!-- Cart Page Start -->
    <main class="cart-page-main-block inner-page-sec-padding-bottom">
        <div class="cart_area cart-area-padding  ">
            <div class="container">
                <div class="page-section-title">
                    <h1 th:text="${categoryGroupBySlug.name}"></h1>
                </div>
            </div>
        </div>
<!--        List Show Here-->


        <section class="">
            <div class="container">
                <div class="row">

                    <th:block th:each = "item : ${productList}">
                        <div class="col-3">
                            <div class="single-slide">
                                <div class="product-card">
                                    <div class="product-header">
                                        <a class="author" th:text="${item.author}"></a>
                                        <h3><a th:href="@{/product-details/__${item.slug}__}" th:text="${item.name}"></a></h3>
                                    </div>
                                    <div class="product-card--body">
                                        <div class="card-image">
                                            <img th:src="${item.avatar}" alt="" width="100%" height="242px" style="margin: 0px 5px">
                                            <div class="hover-contents">
<!--                                                <a href="product-details.html" class="hover-image">-->
<!--                                                    <img th:src="${item.avatar}" alt="">-->
<!--                                                </a>-->
                                                <div class="hover-btns">
                                                    <a href="cart.html" class="single-btn">
                                                        <i class="fas fa-shopping-basket"></i>
                                                    </a>
                                                    <a href="#" data-toggle="modal" data-target="#quickModal" th:data-id ="${item.id}"
                                                       class="single-btn showProductDetails">
                                                        <i class="fas fa-eye"></i>
                                                    </a>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="price-block">
                                            <th:block th:if = "${item.percentageDiscount == 0}">
                                                <span class="price" th:text="${item.price}"></span>
                                            </th:block>
                                            <th:block th:if = "${item.percentageDiscount != 0}">
                                                <span class="price" th:text="${item.lastPrice}"></span>
                                                <del class="price-old" th:text="${item.price}"></del>
                                                <span class="price-discount" th:text="${item.percentageDiscount + '%'}"></span>
                                            </th:block>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </th:block>

                </div>
            </div>
        </section>


    </main>

    <section class="">
        <div class="container">
            <div class="section-title section-title--bordered">
                <h2>YOU MAY LIKE THIS</h2>
            </div>
            <div class="product-slider sb-slick-slider slider-border-single-row" data-slick-setting='{
                "autoplay": true,
                "autoplaySpeed": 8000,
                "slidesToShow": 4,
                "dots":true
            }' data-slick-responsive='[
                {"breakpoint":1200, "settings": {"slidesToShow": 4} },
                {"breakpoint":992, "settings": {"slidesToShow": 3} },
                {"breakpoint":768, "settings": {"slidesToShow": 2} },
                {"breakpoint":480, "settings": {"slidesToShow": 1} }
            ]'>
                <th:block th:each = "item : ${recommendProduct}">
                    <div class="single-slide">
                        <div class="product-card">
                            <div class="product-header">
                                <a class="author" th:text="${item.author}"></a>
                                <h3><a th:href="@{/product-details/__${item.slug}__}" th:text="${item.name}"></a></h3>
                            </div>
                            <div class="product-card--body">
                                <div class="card-image">
                                    <img th:src="${item.avatar}" alt="" width="100%" height="242px">
                                    <div class="hover-contents">
                                        <div class="hover-btns">
                                            <a href="cart.html" class="single-btn">
                                                <i class="fas fa-shopping-basket"></i>
                                            </a>
                                            <a href="#" data-toggle="modal" data-target="#quickModal" th:data-id ="${item.id}"
                                               class="single-btn showProductDetails">
                                                <i class="fas fa-eye"></i>
                                            </a>
                                        </div>
                                    </div>
                                </div>
                                <div class="price-block">
                                    <th:block th:if = "${item.percentageDiscount == 0}">
                                        <span class="price" th:text="${item.price}"></span>
                                    </th:block>
                                    <th:block th:if = "${item.percentageDiscount != 0}">
                                        <span class="price" th:text="${item.lastPrice}"></span>
                                        <del class="price-old" th:text="${item.price}"></del>
                                        <span class="price-discount" th:text="${item.percentageDiscount +'%'}"></span>
                                    </th:block>
                                </div>
                            </div>
                        </div>
                    </div>
                </th:block>
            </div>
        </div>
    </section>

</div>
<!-- Modal -->
<div class="modal fade modal-quick-view" id="quickModal" tabindex="-1" role="dialog"
     aria-labelledby="quickModal" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered " role="document">
        <div class="modal-content">
            <button type="button" class="close modal-close-btn ml-auto" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
            <div class="product-details-modal">
                <div class="row">
                    <div class="col-lg-5">
                        <div class="single-slide" id="avatar-product"></div>
                    </div>
                    <div class="col-lg-7 mt--30 mt-lg--30">
                        <div class="product-details-info pl-lg--30 ">
                            <span class="tag-block" id="modal-author"></span>
                            <h3 class="product-title" id="modal-title"></h3>
                            <ul class="list-unstyled">
                                <li>Ex Tax: <span class="list-value"> Â£60.24</span></li>
                                <li>Brands: <a class="list-value font-weight-bold" id="modal-brand"></a></li>
                                <li>Reward Points: <span class="list-value" id="modal-reward"></span></li>
                                <li>Availability: <span class="list-value" id="modal-status"></span></li>
                            </ul>
                            <div class="price-block">
                                <span class="price-new" id="modal-price-new"></span>
                                <del class="price-old" id="modal-price-old"></del>
                            </div>
                            <div class="rating-widget">
                                <div class="rating-block">
                                    <span class="fas fa-star star_on"></span>
                                    <span class="fas fa-star star_on"></span>
                                    <span class="fas fa-star star_on"></span>
                                    <span class="fas fa-star star_on"></span>
                                    <span class="fas fa-star "></span>
                                </div>
                                <div class="review-widget">
                                    <a href="#">(1 Reviews)</a> <span>|</span>
                                    <a href="#">Write a review</a>
                                </div>
                            </div>
                            <article class="product-details-article">
                                <h4 class="sr-only">Product Summery</h4>
                                <p id="modal-description"></p>
                            </article>
                            <div class="add-to-cart-row">
                                <div class="count-input-block">
                                    <span class="widget-label">Qty</span>
                                    <input type="number" class="form-control text-center amount-product" value="1">
                                </div>
                                <div class="add-cart-btn">
                                </div>
                            </div>
                            <div class="compare-wishlist-row">
                                <span id="modal-info"></span>
                                <a><i class="fas fa-headphones-alt"></i> Contact Us For Help: + 0123.4567.89</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <div class="widget-social-share">
                    <span class="widget-label">Share:</span>
                    <div class="modal-social-share">
                        <a href="#" class="single-icon"><i class="fab fa-facebook-f"></i></a>
                        <a href="#" class="single-icon"><i class="fab fa-twitter"></i></a>
                        <a href="#" class="single-icon"><i class="fab fa-youtube"></i></a>
                        <a href="#" class="single-icon"><i class="fab fa-google-plus-g"></i></a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<section class="section-margin">
    <th:block th:include="layout/brand-slider"/>
</section>
<th:block th:include="layout/footer"/>

<th:block th:include="layout/script"/>

<!--<script src="/assets/js/app.js"></script>-->
<!--<script src="/assets/js/sweetalert2.min.js"></script>-->
<!--<script src="/assets/js/notify-0.4.1.min.js"></script>-->


<script>

    $(".showProductDetails").on("click", function() {
        let id = $(this).data("id");
        $.ajax({
            type: "GET",
            url: "/cp/api/products/getById/" + id,
        }).done((product) => {
            let linkAuthor = `Tags: <a href="#">${product.author}</a>`;
            $("#modal-author").html(linkAuthor);

            $("#modal-title").html(product.name);

            $("#modal-brand").html(product.publishingCompany);

            $("#modal-reward").html(product.rewardPoint);

            if (product.quantity > 0) {
                $("#modal-status").html("In Stock");
            } else {
                $("#modal-status").html("Out of order");
            }

            if(product.percentageDiscount > 0) {
                $("#modal-price-new").html(product.lastPrice);
                $("#modal-price-old").html(product.price);
            } else {
                $("#modal-price-new").html(product.lastPrice);
                $("#modal-price-old").addClass("d-none");
            }

            let avatar = `<img src="${product.avatar}" alt="product-image" width="100%" height="415px">`

            $("#avatar-product").html(avatar) ;

            $("#modal-description").html(product.description);

            let btnAddCart = `<a class="btn btn-outlined--primary" id="modal-addCart" data-id="${product.id}"><i class="fas fa-cart-plus"></i> Add to Cart</a>`;
            $(".add-cart-btn").html(btnAddCart)

            let linkInfo = `<a class="add-link" href="product-details/${product.slug}"><i class="fas fa-book-open"></i>More Information</a>`;
            $("#modal-info").html(linkInfo);
        });

    });

    function createCartDetail() {
        $(".add-cart-btn").on("click", function () {

            let id_customer = $("#customer-login").data("id");

            if(id_customer !=null){
                let id_product = $("#modal-addCart").data("id");
                let amount = $(".amount-product").val();

                let cartDetailDTO = {
                    customerId: id_customer,
                    productId: id_product,
                    quantity: amount
                }

                $.ajax({
                    type: "POST",
                    headers: {
                        'Accept': 'application/json',
                        'Content-Type': 'application/json'
                    },
                    url: "/cp/api/cart-detail/create",
                    data: JSON.stringify(cartDetailDTO)
                }).done((resp) => {
                    // $.notify("Order success , please waiting store accept  ! Thank you !", "success");
                    App.showSuccessAlert("Add cart success ! Thank you !");
                    $(".amount-product").val(1);
                    $("#quickModal").modal('hide');
                }).fail((jqXHR) => {
                    // $.notify("Please check the information again", "error");
                    if (amount > 1000 || amount <= 0) {
                        App.showErrorAlert("Buy quantity must be greater than 0 and less than 1000!")
                    } else {
                        App.showErrorAlert("Please check the information again !")
                    }
                });
            } else {
                // App.showErrorAlert("Please login to add cart  !")
                setTimeout(function () {
                    window.location.href = "/login-register.html";
                }, 500);
            }
        });
    }
    createCartDetail() ;
</script>
</body>
</html>